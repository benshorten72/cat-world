<!DOCTYPE html>
<html>

<head>
  <title>Main Page</title>
  <style>
    iframe {
      width: 100vw;
      height: 80vh;
      border: none;
    }

    body {
      padding: 25px;
      background-color: #f0f1f3;
      font-family: "Arial", sans-serif;
    }

    #place-picker-box {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    #place-picker-container {
      text-align: left;
    }
  </style>

</head>

<body>
  <h1 style="position:absolute; z-index:2; color:white;">Cat World</h1>
  <iframe id="iframe" src="globe.html"></iframe>
  <h1>Hello</h1>
  <div id="app">
    <button id="loadCats">Load Cats</button>
  </div>
  <script>

    document.addEventListener("DOMContentLoaded", () => {
      var button = document.querySelector("#loadCats");
      console.log('Button found:', button);
      button.addEventListener("click", () => {
        console.log("Button clicked!");
        loadCats();
      });
    });

async function loadCats() {
  const iframe = document.getElementById('iframe');
  if (!iframe) {
    console.error('iframe not found');
    return;
  }

  try {
    const res = await fetch('/api/posts');
    const data = await res.json();
    console.log("payload", data.payload);
          const msg = {
        type: 'newData',
        payload: data.payload
      };

      console.log("Sending message:", msg);
      iframe.contentWindow.postMessage(msg, '*');
  } catch (err) {
    console.error(err);
  }
}

  </script>

  <body>
    <h2>Upload a Cat Image</h2>
    <form id="uploadForm" enctype="multipart/form-data" method="POST" action="/api/posts">
      <label for="caption">Caption:</label><br>
      <input type="text" id="caption" name="caption" required><br><br>

      <label for="image">Select image:</label><br>
      <input type="file" id="image" name="image" accept="image/*" required><br><br>
      <label>Meow MP3 File:</label>
      <input type="file" id="audio" name="audio" accept=".mp3" required />

      <button type="submit">Upload</button>
    </form>
  </body>
</body>

</html>